<html>
    <head>
        <title>Dashboard</title>
        <%= javascript_include_tag "//www.google.com/jsapi", "chartkick" %>
    </head>
    <body>
    <canvas id="myChart" width="800" height="400"></canvas>
    <canvas id="myChartBis" width="800" height="400"></canvas>

        <h2>Dashboard</h2>
        
        <% @data.each do |event| %>
            <%=event['type'] %>
            <br/>
        <% end %>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
        <script>

            //    ########################################
            //    Pour les occurences de commit par heures
            //    ########################################

            var ctx = document.getElementById("myChart").getContext("2d");
            var hours = new Array();
            var commits = new Array();

            for(i = 0;i < 24; i++){
                hours.push(i + "h");
            }

            hours.forEach(function(){

                // TODO : aller chercher les vrais valeurs pour chaque tranche horaire
                commits.push((Math.random() * 1000) + 1);
            });
            var data = {
                labels: hours,
                datasets: [
                    {
                        label: "Nombre de commit par heure",
                        fillColor: "rgba(151,187,205,0.2)",
                        strokeColor: "rgba(151,187,205,1)",
                        pointColor: "rgba(151,187,205,1)",
                        pointStrokeColor: "#fff",
                        pointHighlightFill: "#fff",
                        pointHighlightStroke: "rgba(151,187,205,1)",
                        data: commits
                    }
                ]
            };
            var myLineChart = new Chart(ctx).Line(data, {bezierCurve: false});





            //    ####################################
            //    Pour le nombre d'�vennement par type
            //    ####################################

            ctx = document.getElementById("myChartBis").getContext("2d");

            // TODO : mettre en dur les noms des diff�rents types d'event
            // TODO : ajouter en dynamique le nombre d'occurences de chaque type d'event
            var data = [
                {
                    value: 300,
                    color:"#F7464A",
                    highlight: "#FF5A5E",
                    label: "Javascript"
                },
                {
                    value: 100,
                    color: "#46BFBD",
                    highlight: "#5AD3D1",
                    label: "Java"
                },
                {
                    value: 70,
                    color: "#FDB45C",
                    highlight: "#FFC870",
                    label: "Ruby"
                }
            ]

            var myPieChart = new Chart(ctx).Pie(data,{animateScale: true});


        </script>
    </body>
</html>

